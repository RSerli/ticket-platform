<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link th:rel="stylesheet" th:href="@{/webjars/bootstrap/5.1.3/css/bootstrap.min.css}" />
    <title>Ticket Service</title>
</head>

<body>
    <header>

        <nav th:replace="fragments/navbar :: navbar('Home')"></nav>

    </header>

    <main>

        <!-- Toast di successo creazione ticket -->
        <th:block th:if="${successAlertMessage != null}">
            <div class="alert alert-success alert-dismissible fade show" role="alert">
                <div th:text="${successAlertMessage}"></div>
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        </th:block>

        <div class="container mt-3">
            <!-- heading di saluto -->
            <h2 th:text="|Ciao ${loggedUser.name}|"> </h2>

            <!-- Alert che non ci sono ticket legati all'user loggato -->
            <th:block th:unless="${loggedUser.assignedTickets.size() > 0}">
                <div class="alert alert-info" role="alert">
                    <div>Non ci sono ticket assegnati a te!</div>
                </div>
            </th:block>

            <!-- Tabella dei ticket legati all'user loggato -->
            <table th:if="${loggedUser.assignedTickets.size() > 0}" class="table table-striped">

                <thead>
                    <tr>
                        <th scope="col"></th> <!-- Header per il pulsante di view del ticket -->
                        <th scope="col">Nome</th> <!-- Header per il nome del ticket -->
                        <th scope="col">Status</th> <!-- Header per lo status del ticket -->
                        <th scope="col">Data Creazione</th> <!-- Header per la data di creazione del ticket -->
                        <th scope="col"></th> <!-- Header per il pulsante della modifica -->
                        <th scope="col"></th> <!-- Header per il pulsante di eliminazione -->
                    </tr>
                </thead>

                <tbody>
                    <tr th:each="singoloTicket : ${loggedUser.assignedTickets}">
                        <td></td>
                        <td th:text="${singoloTicket.nome}"></td>
                        <!-- cella dello status -->
                        <td th:if="${singoloTicket.actualStatus.getId() == 1}">
                            <span class="text-danger" th:text="${singoloTicket.actualStatus.getName()}"></span>
                        </td>
                        <td th:if="${singoloTicket.actualStatus.getId() == 2}">
                            <span class="text-warning" th:text="${singoloTicket.actualStatus.getName()}"></span>
                        </td>
                        <td th:if="${singoloTicket.actualStatus.getId() == 3}">
                            <span class="text-success" th:text="${singoloTicket.actualStatus.getName()}"></span>
                        </td>
                        <td th:text="${singoloTicket.createdAt}"></td>
                        <td></td>
                        <td></td>
                    </tr>
                </tbody>

            </table>

        </div>


    </main>
    <!-- Bootstrap Bundle with Popper -->
    <script th:src="@{/webjars/bootstrap/5.1.3/js/bootstrap.bundle.min.js}"></script>
</body>

</html>